# AI Module Database Management System

Система управления базой данных модулей искусственного интеллекта. Консольное приложение с CRUD операциями и дополнительной бизнес-логикой для работы с тремя связанными таблицами.

## Быстрый старт

### Компиляция:
```bash
make build_db
```

### Запуск:
```bash
./modules_db
```

### Очистка:
```bash
make clean
```

## Структура проекта

```
ai_module_manager/
├── src/
│   ├── modules_db.c              # Основная программа (меню)
│   ├── shared.c                  # Общие функции и бизнес-логика
│   ├── shared.h                  # Заголовочный файл общих функций
│   ├── master_modules.c          # CRUD операции для таблицы модулей
│   ├── master_modules.h          # Структура модуля
│   ├── master_levels.c           # CRUD операции для таблицы уровней
│   ├── master_levels.h           # Структура уровня
│   ├── master_status_events.c    # CRUD операции для таблицы событий
│   ├── master_status_events.h    # Структура события статуса
│   ├── index.c                   # Индексация и быстрый поиск
│   ├── index.h                   # Структура индексной записи
│   ├── database.h                # Общий интерфейс базы данных
│   └── Makefile                  # Система сборки
├── materials/
│   ├── master_modules.db         # Бинарный файл модулей
│   ├── master_levels.db          # Бинарный файл уровней
│   ├── master_status_events.db   # Бинарный файл событий
│   └── db_logs.txt               # Логи базы данных
└── README.md
```

## Описание системы

### Структура базы данных

#### 1. Таблица `Modules` (master_modules.db)
```c
typedef struct {
    int id;             // ID модуля
    char name[30];      // Название модуля (30 символов)
    int level;          // Уровень расположения (1-4)
    int cell;           // Ячейка на уровне (1-4)
    int deleted;        // Флаг удаления (0 - активен, 1 - удален)
} Module;
```

#### 2. Таблица `Levels` (master_levels.db)
```c
typedef struct {
    int level;          // Номер уровня (1-4)
    int cells;          // Количество ячеек на уровне (фиксировано 4)
    int protected;      // Флаг защиты уровня (0 - незащищен, 1 - защищен)
} Level;
```

#### 3. Таблица `StatusEvents` (master_status_events.db)
```c
typedef struct {
    int eventId;        // ID события
    int moduleId;       // ID модуля
    int newStatus;      // Новый статус (0-20)
    char date[11];      // Дата события в формате "DD.MM.YYYY"
    char time[9];       // Время события в формате "HH:MM:SS"
} StatusEvent;
```

## Основные операции

### 1. CRUD операции

#### SELECT - Просмотр данных
```
Выберите таблицу:
1. Modules
2. Levels  
3. Status events
```

Пример вывода Modules:
```
ID      Name                    Level   Cell    Deleted
0       Main module             4       3       0
1       Text module             2       3       0
2       Audio module            3       4       0
3       Speech module           1       2       0
4       Fuzzy module            4       3       0
```

#### INSERT - Добавление записи
```
Введите данные:
Для Modules: id name level cell deleted
Для Levels: level cells protected  
Для StatusEvents: eventId moduleId newStatus date time
```

#### UPDATE - Обновление записи
```
Введите ID записи для обновления
Введите новые данные
```

#### DELETE - Удаление записи
```
Введите ID записи для удаления
```

### 2. Специальные операции

#### 5. Получить активные модули (статус 1)
Выводит все модули со статусом 1 из таблицы StatusEvents.

#### 6. Удалить модуль по ID
Мягкое удаление - устанавливает флаг `deleted = 1`.

#### 7. Защитить уровень по номеру
Устанавливает флаг `protected = 1` для указанного уровня.

#### 8. Переместить модуль в новое место
Изменяет уровень и ячейку модуля.

#### 9. Установить флаг защиты для уровня
Аналогично операции 7.

#### 10. ОТКЛЮЧИТЬ СИСТЕМУ ИИ
Критическая операция:
1. Деактивирует все дополнительные модули
2. Переводит главный модуль на первый уровень
3. Защищает первый уровень
4. Удаляет все остальные модули на первом уровне

#### 11. Получить модули первого уровня
Выводит все неделированные модули на первом уровне.

#### 12. СОЗДАТЬ ИНДЕКСЫ
Создает индексные файлы для быстрого поиска по ID.

#### 13. БЫСТРЫЙ SELECT с индексами
Использует индексы для ускоренного поиска записей.

## Меню программы

```
Выберите операцию:
1. SELECT
2. INSERT  
3. UPDATE
4. DELETE
5. Получить активные модули (статус 1)
6. Удалить модуль по ID
7. Защитить уровень по номеру
8. Переместить модуль в новое место
9. Установить флаг защиты для уровня
10. ОТКЛЮЧИТЬ СИСТЕМУ ИИ
11. Получить модули первого уровня
12. СОЗДАТЬ ИНДЕКСЫ
13. БЫСТРЫЙ SELECT с индексами
14. Выйти
```

## Особенности реализации

1. **Бинарное хранение данных** - все таблицы хранятся в бинарных файлах
2. **Индексация** - поддержка быстрого поиска через индексные файлы
3. **Мягкое удаление** - флаг `deleted` вместо физического удаления
4. **Защита уровней** - система безопасности с защищенными уровнями
5. **Бизнес-логика ИИ** - специализированные операции для управления ИИ-системой

## Пример данных

### Модули:
```
0  Main module          4 3 0
1  Text module          2 3 0  
2  Audio module         3 4 0
3  Speech module        1 2 0
4  Fuzzy module         4 3 0
5  Neural module        1 1 0
```

### Уровни:
```
1 4 0
2 4 0
3 4 0
4 4 0
```

### События статусов:
```
0 0 1 05.11.2020 08:43:59
1 1 1 08.07.2020 02:07:10
2 2 1 28.11.2020 06:03:02
3 3 1 15.01.2020 15:36:22
```

## Зависимости

- Компилятор C (gcc, clang)
- Стандартная библиотека C

## Автор

**Кашапов Нияз** — студент Школы 21 (Казань)  
GitHub: [millember](https://github.com/millember)

---

*Учебный проект по языку C и работе с базами данных.*
